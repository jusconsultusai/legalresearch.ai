services:
  onlyoffice:
    image: onlyoffice/documentserver:latest
    container_name: jusconsultus-onlyoffice
    ports:
      - "8000:80"
      - "8443:443"
    environment:
      # JWT secret for secure communication
      JWT_ENABLED: "true"
      JWT_SECRET: "${ONLYOFFICE_JWT_SECRET:-your-secret-key-change-in-production}"
      JWT_HEADER: "Authorization"
    volumes:
      - onlyoffice-data:/var/www/onlyoffice/Data
      - onlyoffice-logs:/var/log/onlyoffice
      - onlyoffice-fonts:/usr/share/fonts
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/healthcheck"]
      interval: 15s
      timeout: 5s
      retries: 5
      start_period: 60s

volumes:
  onlyoffice-data:
  onlyoffice-logs:
  onlyoffice-fonts:
